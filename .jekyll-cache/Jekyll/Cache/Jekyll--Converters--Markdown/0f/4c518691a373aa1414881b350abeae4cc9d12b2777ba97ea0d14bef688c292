I"™Ñ<h1 id="ì„œë¡ ">ì„œë¡ </h1>

<p>Log API ë¥¼ ê°œë°œí•˜ë©´ì„œ API ë¬¸ì„œë¥¼ ì‘ì„±í•´ì•¼ í–ˆë‹¤.  <br />
<code class="language-plaintext highlighter-rouge">Swagger</code>ëŠ” ëª…ë£Œí•œ ë¬¸ì„œë¥¼ ì œê³µí•˜ëŠ”ë° ì í•©í•´ ë³´ì´ì§€ ì•Šì•„ì„œ ì»¨í”Œë£¨ì–¸ìŠ¤ì— ì§ì ‘ ì‘ì„±ì„ í–ˆì—ˆë‹¤.  <br />
API ê°œë°œê³¼ ë¬¸ì„œì‘ì„±ì„ í•¨ê»˜ ì§„í–‰í•˜ë‹¤ë³´ë‹ˆ API End point ê°€ ë³€ê²½ë  ë•Œë‚˜ ì½”ë“œì˜ ë³€ê²½ì‚¬í•­ì´ ìˆì„ ë•Œ ë§¤ë²ˆ ìˆ˜ì •ì„ í•´ì•¼í•˜ëŠ” ë‹¨ì ì´ ìˆì–´ API ë¬¸ì„œ ìë™í™”ë¥¼ ì•Œì•„ë³´ê²Œ ë˜ì—ˆê³ , <code class="language-plaintext highlighter-rouge">Spring REST Docs</code>ë¥¼ ì ìš©í•´ë´¤ë‹¤.</p>

<h1 id="spring-rest-docs--restful-ì„œë¹„ìŠ¤-ë¬¸ì„œí™”ì‘ì—…ì„-ë„ì™€ì£¼ëŠ”-ë¼ì´ë¸ŒëŸ¬ë¦¬">Spring REST Docs : RESTful ì„œë¹„ìŠ¤ ë¬¸ì„œí™”ì‘ì—…ì„ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬</h1>

<p>ìë°” ë¬¸ì„œ ìë™í™”ì—ëŠ” ì£¼ë¡œ <code class="language-plaintext highlighter-rouge">Swagger</code> ì™€ <code class="language-plaintext highlighter-rouge">Spring Rest Docs</code> ê°€ ì‚¬ìš©ëœë‹¤.</p>

<p>ê°ê°ì˜ ì¥ì ê³¼ ë‹¨ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.Spring Rest Docsë¥¼ ì ìš©í•˜ë©´ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±ì„ í•´ì•¼í–ˆëŠ”ë°, ë‚˜ëŠ” ì²˜ìŒì´ë¼ ë§ì´ í—¤ë§¸ë‹¤. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì— ìµìˆ™ì¹˜ ì•Šë‹¤ë©´ ì ìš©í•˜ëŠ”ë° ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Â </th>
      <th style="text-align: left">**Swagger**</th>
      <th style="text-align: left">**Spring REST Docs**</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">ì¥ì </td>
      <td style="text-align: left">APIë¥¼ í…ŒìŠ¤íŠ¸ í•´ ë³¼ ìˆ˜ ìˆë‹¤.</td>
      <td style="text-align: left">í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•´ì•¼ ë¬¸ì„œê°€ ì‘ì„±ëœë‹¤.</td>
    </tr>
    <tr>
      <td style="text-align: left">Â </td>
      <td style="text-align: left">ì ìš©í•˜ê¸° ì‰½ë‹¤.</td>
      <td style="text-align: left">ì½”ë“œì™€ ë¬¸ì„œê°€ ë¶„ë¦¬ë˜ì–´ ìˆë‹¤.</td>
    </tr>
    <tr>
      <td style="text-align: left">ë‹¨ì </td>
      <td style="text-align: left">ì½”ë“œì— ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤</td>
      <td style="text-align: left">ì ìš©í•˜ê¸° ì–´ë µë‹¤.  ((ê°œì¸) í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì´ ìµìˆ™ì¹˜ ì•Šìœ¼ë©´ ì ìš©í•˜ëŠ”ë° ë” ì˜¤ë˜ ê±¸ë¦°ë‹¤)</td>
    </tr>
    <tr>
      <td style="text-align: left">Â </td>
      <td style="text-align: left">ì½”ë“œì™€ ë™ê¸°í™”ê°€ ì•ˆ ë  ìˆ˜ ìˆë‹¤.</td>
      <td style="text-align: left">Â </td>
    </tr>
  </tbody>
</table>

<h1 id="ì ìš©í•˜ê¸°">ì ìš©í•˜ê¸°</h1>

<p>í™˜ê²½ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
  <li>SpringBoot 2.6.4</li>
  <li>Maven</li>
  <li>Java 8</li>
  <li>JUnit 4.13.2</li>
  <li>AsciiDoc</li>
</ul>

<p>Spring REST docs ì ìš©ì„ ì¤‘ì ìœ¼ë¡œ ì‘ì„±í–ˆë‹¤. <del>í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ì‚¬ì‹¤ ì²˜ìŒì´ë¼ ë‹¤ë¥¸ ë¬¸ì„œ ë³´ì‹œê¸¸..</del></p>

<h2 id="pomxml">pom.xml</h2>

<ul>
  <li>dependency
    <ul>
      <li><code class="language-plaintext highlighter-rouge">spring-restdocs-mockmvc</code>
        <ul>
          <li>mockmvc ë¥¼ restdoc ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>build plugin
    <ul>
      <li><code class="language-plaintext highlighter-rouge">asciidoctor-maven-plugin</code>
        <ul>
          <li>Asciidoctor ë¥¼ ì‚¬ìš©í•˜ì—¬ AsciiDocë¬¸ì„œë¥¼ html(default)ë¡œ ë³€í™˜í•¨</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ë” ìì„¸í•œ Build Configuration ì€ <a href="https://docs.spring.io/spring-restdocs/docs/current/reference/html5/#getting-started-build-configuration">ê³µì‹ ë¬¸ì„œ</a> ì°¾ì•„ë³´ê¸°</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;dependencies&gt;</span>
   <span class="nt">&lt;dependency&gt;</span>
     <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
     <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
   <span class="nt">&lt;/dependency&gt;</span>
   <span class="nt">&lt;dependency&gt;</span>
     <span class="nt">&lt;groupId&gt;</span>org.springframework.restdocs<span class="nt">&lt;/groupId&gt;</span>
     <span class="nt">&lt;artifactId&gt;</span>spring-restdocs-mockmvc<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
  <span class="nt">&lt;/dependencies&gt;</span>

  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.asciidoctor<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>asciidoctor-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.5.8<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;dependencies&gt;</span>
          <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.restdocs<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-restdocs-asciidoctor<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.0.2.RELEASE<span class="nt">&lt;/version&gt;</span>
          <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;/dependencies&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>asciidoc-to-html<span class="nt">&lt;/id&gt;</span>
             <span class="c">&lt;!-- asciidoctorê°€ ë™ì‘í•˜ëŠ” ì‹œì  ì •ì˜ --&gt;</span>
            <span class="nt">&lt;phase&gt;</span>prepare-package<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>process-asciidoc<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
              <span class="nt">&lt;backend&gt;</span>html5<span class="nt">&lt;/backend&gt;</span>
              <span class="nt">&lt;sourceHighlighter&gt;</span>coderay<span class="nt">&lt;/sourceHighlighter&gt;</span>
              <span class="nt">&lt;preserveDirectories&gt;</span>true<span class="nt">&lt;/preserveDirectories&gt;</span>
              <span class="c">&lt;!-- .adocíŒŒì¼ë“¤ì„ í† ëŒ€ë¡œ ë§Œë“  ì›¹ ë¬¸ì„œë¥¼ ì €ì¥í•  ìœ„ì¹˜ ì„ íƒ --&gt;</span>
              <span class="nt">&lt;outputDirectory&gt;</span>src/main/resources/static<span class="nt">&lt;/outputDirectory&gt;</span>
              <span class="nt">&lt;attributes&gt;</span>
                <span class="nt">&lt;java-version&gt;</span>${java.version}<span class="nt">&lt;/java-version&gt;</span>
                <span class="nt">&lt;spring-restdocs-version&gt;</span>${spring-restdocs.version}<span class="nt">&lt;/spring-restdocs-version&gt;</span>
                <span class="nt">&lt;basedir&gt;</span>${project.basedir}<span class="nt">&lt;/basedir&gt;</span>
              <span class="nt">&lt;/attributes&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>


</code></pre></div></div>

<h2 id="ê¸°ì´ˆ-document-ì½”ë“œ-ì‘ì„±"><strong>[ê¸°ì´ˆ] Document ì½”ë“œ ì‘ì„±</strong></h2>

<p>test íŒ¨í‚¤ì§€ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤</p>

<p><img src="https://swimmingHwang.github.io/img/Gruntfile.png" alt="image-20220423180745372" /></p>

<h3 id="1-customizing-requests-and-responses"><strong>1. Customizing requests and responses</strong></h3>

<p>Spring REST DocsëŠ” ë¬¸ì„œí™” ì „ì²˜ë¦¬ê¸°ë¥¼ ì œê³µí•œë‹¤. ì´ëŠ” ìš”ì²­ì´ë‚˜ ì‘ë‹µì„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.ì˜ˆë¥¼ ë“¤ì–´, localì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ ì‹¤ì œ urlì€ localhost:port ì¼í…Œì§€ë§Œ  urlì„ ì§€ì •í•˜ëŠ” ë“± ì „ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.í—¤ë” ì œê±°ë„ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">getDocumentRequest</code>, <code class="language-plaintext highlighter-rouge">getDocumentResponse</code> static ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì–»ì–´ ì‚¬ìš©í•œë‹¤.</p>

<h3 id="apidocumentutils"><strong>ApiDocumentUtils</strong></h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.xxxxx.xxxx.logapi.utils</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">operation</span><span class="o">.</span><span class="na">preprocess</span><span class="o">.</span><span class="na">Preprocessors</span><span class="o">.</span><span class="na">modifyUris</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">operation</span><span class="o">.</span><span class="na">preprocess</span><span class="o">.</span><span class="na">Preprocessors</span><span class="o">.</span><span class="na">preprocessRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">operation</span><span class="o">.</span><span class="na">preprocess</span><span class="o">.</span><span class="na">Preprocessors</span><span class="o">.</span><span class="na">preprocessResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">operation</span><span class="o">.</span><span class="na">preprocess</span><span class="o">.</span><span class="na">Preprocessors</span><span class="o">.</span><span class="na">prettyPrint</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.restdocs.operation.preprocess.OperationRequestPreprocessor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.restdocs.operation.preprocess.OperationResponsePreprocessor</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ApiDocumentUtils</span> <span class="o">{</span>

  <span class="kd">static</span> <span class="nc">OperationRequestPreprocessor</span> <span class="nf">getDocumentRequest</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">preprocessRequest</span><span class="o">(</span>
        <span class="n">modifyUris</span><span class="o">()</span><span class="c1">// (1) ë¬¸ì„œìƒ URI ë³€ê²½</span>
            <span class="o">.</span><span class="na">scheme</span><span class="o">(</span><span class="s">"https"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">host</span><span class="o">(</span><span class="s">"xxxxx.xxxxxxx.com"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">port</span><span class="o">(</span><span class="mi">37000</span><span class="o">),</span>
        <span class="n">prettyPrint</span><span class="o">());</span><span class="c1">// (2) request ì˜ˆì˜ê²Œ ì¶œë ¥</span>
  <span class="o">}</span>

  <span class="kd">static</span> <span class="nc">OperationResponsePreprocessor</span> <span class="nf">getDocumentResponse</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">preprocessResponse</span><span class="o">(</span><span class="n">prettyPrint</span><span class="o">());</span><span class="c1">// (3) response ì˜ˆì˜ê²Œ ì¶œë ¥  }</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="2-í…ŒìŠ¤íŠ¸-ì½”ë“œ-ì‘ì„±---ì˜ˆì‹œ-ì¸ì¦-í† í°-ë°œê¸‰"><strong>2. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± - ì˜ˆì‹œ) ì¸ì¦ í† í° ë°œê¸‰</strong></h3>

<ul>
  <li>andDo ë’¤ì— ë¬¸ì„œí™”ì— ì‚¬ìš©ë˜ëŠ” í•­ëª©ë“¤ ì‘ì„±í•´ ì£¼ë©´ ëœë‹¤.</li>
  <li>ìš”ì²­ í•„ë“œ, ì‘ë‹µ í•„ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìœ¼ë©°, ë” ë§ì€ ê¸°ëŠ¥ì€ [ì‘ìš©] ë¶€ë¶„ì—ì„œ ìì„¸íˆ ë‹¤ë£¸.
    <ul>
      <li>íƒ€ì… ì§€ì • ê°€ëŠ¥</li>
      <li>description ì‘ì„± ê°€ëŠ¥</li>
      <li>í•„ìˆ˜ê°’ ì—¬ë¶€ ì‘ì„± ê°€ëŠ¥</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="n">í† í°ë°œê¸‰</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
<span class="c1">// given</span>
	<span class="nc">TokenRequest</span> <span class="n">tokenRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TokenRequest</span><span class="o">();</span>
	<span class="n">tokenRequest</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
	<span class="n">tokenRequest</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">"password"</span><span class="o">);</span>

<span class="c1">// when</span>
	<span class="nc">ResultActions</span> <span class="n">result</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">mockMvc</span>
			<span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/v1/token"</span><span class="o">)</span>
					<span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
					<span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">tokenRequest</span><span class="o">)));</span>

<span class="c1">// then</span>
	<span class="n">result</span><span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
			<span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span><span class="s">"token-api"</span><span class="o">,</span><span class="c1">// í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì‹œ token-api í´ë” í•˜ìœ„ì— ë¬¸ì„œê°€ ì‘ì„±ëœë‹¤</span>
					<span class="n">getDocumentRequest</span><span class="o">(),</span>
					<span class="n">getDocumentResponse</span><span class="o">(),</span>
					<span class="n">requestFields</span><span class="o">(</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"username"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì•„ì´ë””"</span><span class="o">),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"password"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íŒ¨ìŠ¤ì›Œë“œ"</span><span class="o">)</span>
					<span class="o">),</span>
					<span class="n">responseFields</span><span class="o">(</span>
							<span class="n">beneathPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">withSubsectionId</span><span class="o">(</span><span class="s">"data"</span><span class="o">),</span>
								<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"username"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì•„ì´ë””"</span><span class="o">),</span>
								<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"tokenType"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"í† í° íƒ€ì…"</span><span class="o">),</span>
								<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"accessToken"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"Access Token"</span><span class="o">)</span>
					<span class="o">)))</span>
			<span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">print</span><span class="o">())</span>
			<span class="o">;</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="3-í…ŒìŠ¤íŠ¸-ì‹¤í–‰"><strong>3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰</strong></h3>

<p>í•´ë‹¹ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ  <code class="language-plaintext highlighter-rouge">target/generated-snippets</code>  ì— adoc íŒŒì¼ì´ ìƒì„±ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://swimmingHwang.github.io/img/image-20220423180927199.png" alt="image-20220423180927199" /></p>

<p>adoc íŒŒì¼ì€ ì´ë ‡ê²Œ ìƒê²¼ê³ ,</p>

<p>[ì˜ˆì‹œ http-request.adoc]</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[source,http,options="nowrap"]
----
POST /v1/token HTTP/1.1
Content-Type: application/json;charset=UTF-8
Content-Length: 56
Host: xxxxx-api.xxxxx.com:37000

{
  "username" : "username",
  "password" : "password"
}
----

</code></pre></div></div>

<p>[ì˜ˆì‹œ response-body.adoc]</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[source,options="nowrap"]
----
{
  "code" : "0000",
  "message" : "SUCCESS",
  "data" : {
    "accessToken" : "eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ1c2VybmFtZSIsImlhdCI6MTY1MDIyMTI0NSwiZXhwIjoxNjU3OTk3MjQ1fQ.Zu2M33AvK88QHQHzxe0n6CKaz5dYXskJxVWvF_9-LB1p9FGIX2pdUu4l4_bH8FJu_kbDqYH9CZ_XBWzPV1G9DA",
    "tokenType" : "Bearer",
    "username" : "username"
  }
}
----

</code></pre></div></div>

<h3 id="4-ì „ì²´-ë¬¸ì„œ-ì‘ì„±"><strong>4. ì „ì²´ ë¬¸ì„œ ì‘ì„±</strong></h3>

<p>ì´ë ‡ê²Œ ìƒì„±ëœ snippet ë“¤ì„ ëª¨ì•„ adoc ë¬¸ì„œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.ì•„ë˜ëŠ” í† í° ë°œê¸‰ ë¬¸ì„œë¥¼ ì¼ë¶€ ë°œì·Œí–ˆë‹¤.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>== 1. í† í° ë°œê¸‰

`/v1/token`

- ì‚¬ì´íŠ¸ì— ë“±ë¡ëœ ìƒìœ„ ê·¸ë£¹ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ API í˜¸ì¶œì— í•„ìš”í•œ í† í°ì„ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤.
- ë°œê¸‰ë°›ì€ í† í°ì„ log ì¡°íšŒ api í˜¸ì¶œ ì‹œ í—¤ë”ì— ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.
- í•´ë‹¹ API ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì‚¬ì´íŠ¸ì—ì„œ ìƒìœ„ê·¸ë£¹ ìƒì„±ì´ í•„ìš”í•˜ë©° ì‚¬ì—…ë¶€ë¡œ ê·¸ë£¹ ìƒì„± ìš”ì²­ì´ í•„ìš”í•©ë‹ˆë‹¤.
- í† í° ìœ íš¨ê¸°ê°„ì€ 3ê°œì›” ì…ë‹ˆë‹¤. í† í° ë°œê¸‰ í›„ 3ê°œì›”ì´ ì§€ë‚œ ê²½ìš° ë§Œë£Œë˜ê¸° ë•Œë¬¸ì— ì¬ë°œê¸‰ì´ í•„ìš”í•©ë‹ˆë‹¤.

=== Request

operation::token-api[snippets='request-fields,request-body,curl-request']

=== Response

operation::token-api[snippets='response-fields-data,response-body,http-response']


</code></pre></div></div>

<h3 id="5-ë¹Œë“œ"><strong>5. ë¹Œë“œ</strong></h3>

<p>ë¹Œë“œê¹Œì§€ ìˆ˜í–‰í•˜ë©´, í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ì‘ì„±ëœ snippetë“¤ì´ í•˜ë‚˜ì˜ Html ë¬¸ì„œë¡œ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì´ì— ëŒ€í•œ ê²°ê³¼ë¬¼ì€ ì´ë ‡ë‹¤.</p>

<p><img src="https://swimmingHwang.github.io/img/image-20220417-191743.png" alt="image-20220417-191743" /></p>

<p>ì—¬ê¸°ê¹Œì§€ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ì ìš© ë° ê²°ê³¼ë¬¼ì´ë‹¤.</p>

<p>ë” ë‚˜ì•„ê°€ í•„ìˆ˜ê°’ ì—¬ë¶€ í‘œí˜„, ì…ë ¥ í¬ë§· í‘œí˜„, ê³µí†µ ì‘ë‹µ ë° ê³µí†µ ì‘ë‹µ ì½”ë“œë¥¼ ìë™í™” í•  ìˆ˜ ìˆë‹¤.</p>

<h2 id="ì‘ìš©-document-ì½”ë“œ-ì‘ì„±">[ì‘ìš©] <strong>Document ì½”ë“œ ì‘ì„±</strong></h2>

<p>Request í•„ë“œì— í•„ìˆ˜ê°’ ì—¬ë¶€ì— ëŒ€í•´ í‘œí˜„ì„ í•˜ëŠ” ë“± ì…ë ¥ í¬ë§·ì— ëŒ€í•´ ì‘ì„±í•  í•„ìš”ê°€ ìˆë‹¤. ê°„ë‹¨í•œ ì„¤ëª…ê³¼ ì˜ˆì‹œë¥¼ ì‘ì„±í–ˆë‹¤. ì´ë¥¼ ì°¸ê³ í•˜ë©´ ì‰½ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>

<ul>
  <li>í•„ìˆ˜ê°’ ì—¬ë¶€</li>
  <li>ì…ë ¥ í¬ë§·</li>
  <li>ê³µí†µ í¬ë§·</li>
  <li>ê³„ì¸µ êµ¬ì¡° ì‘ë‹µ</li>
</ul>

<h3 id="1-í•„ìˆ˜ê°’-ì—¬ë¶€"><strong>1. í•„ìˆ˜ê°’ ì—¬ë¶€</strong></h3>

<p>í•„ìˆ˜ê°’ ì—¬ë¶€ë¥¼ í‘œí˜„í•˜ë ¤ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ spring REST Docsì—ì„œ ì œê³µí•˜ëŠ” optional ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. Request í•„ë“œ ì‘ì„± ì‹œì— .optional() ì„ ë¶™ì—¬ ì„ íƒ í•­ëª©ì„ì„ ì•Œë ¤ì¤„ ìˆ˜ ìˆê³  snippet ì„ customizing í•˜ì—¬ optionalì´ falseì¼ ë•Œ í•„ìˆ˜ê°’ì„ì„ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.</p>

<ul>
  <li>snippet customizing
    <ul>
      <li><code class="language-plaintext highlighter-rouge">src/test/resources/org/springframework/restdocs/templates</code> <code class="language-plaintext highlighter-rouge">request-fields.snippet</code> íŒŒì¼ì„ ì¶”ê°€</li>
    </ul>
  </li>
</ul>

<p>[reqeust-fields.snippet]</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>|===
|í•„ë“œëª…|íƒ€ì…|í•„ìˆ˜ì—¬ë¶€|ì–‘ì‹|ì„¤ëª…


|`++`
|`++`
|true
|
|


|===

</code></pre></div></div>

<p>ìŠ¤ë‹ˆí«ì€ mustache ë¬¸ë²•ì„ ì‚¬ìš©í•œë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œ ì»¤ìŠ¤í…€ í•  ìˆ˜ ìˆë‹¤. íƒ€ì´í‹€ë„ ì¶”ê°€í•  ìˆ˜ ìˆê³  í‘œì˜ í—¤ë” í•­ëª©ë„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>

<p>mustache ë¬¸ë²• ì¤‘ <code class="language-plaintext highlighter-rouge">}}</code> ì€ paramì´ ë¹„ì–´ìˆê±°ë‚˜ false ì¼ë•Œ ì‘ë™ëœë‹¤. (ê¸°íƒ€ mustache ë¬¸ë²•ì€ ë‹¤ë¥¸ ë¬¸ì„œ ì°¸ê³ ..)</p>

<h3 id="ì˜ˆì‹œ"><strong>ì˜ˆì‹œ</strong></h3>

<ul>
  <li>í•„ë“œ 4ê°œ ëª¨ë‘ ì„ íƒ í•­ëª©ì´ì–´ì„œ optional ì„ ë¶™ì—¬ì£¼ë©´ ëœë‹¤. í•„ìˆ˜ ì—¬ë¶€ì— ê³µë°±ì„(false)ì„ ë³¼ ìˆ˜ ìˆë‹¤.
    <ul>
      <li><del>ì‚¬ì‹¤ false ë¡œ í‘œí˜„í•˜ê³  ì‹¶ì€ë° ì‹œê°„ìƒ ëª»í–ˆìŒ..</del></li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="n">requestFields</span><span class="o">(</span>
<span class="mi">2</span>		<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"startDate"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">attributes</span><span class="o">(</span><span class="n">getDateFormat</span><span class="o">()).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë¡œê·¸ ì¡°íšŒ ì‹œì‘ ë‚ ì§œ"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
<span class="mi">3</span>		<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"endDate"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">attributes</span><span class="o">(</span><span class="n">getDateFormat</span><span class="o">()).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë¡œê·¸ ì¡°íšŒ ë ë‚ ì§œ"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
<span class="mi">4</span>		<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"pageNum"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"í˜ì´ì§€ ë²ˆí˜¸"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
<span class="mi">5</span>		<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"pageSize"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì¡°íšŒ ê±´ìˆ˜"</span><span class="o">).</span><span class="na">optional</span><span class="o">()</span>
<span class="mi">6</span><span class="o">),</span>
</code></pre></div></div>

<p><img src="https://swimmingHwang.github.io/img/image-20220417-193942.png" alt="image-20220417-193942" /></p>

<h3 id="2-ì…ë ¥-í¬ë§·"><strong>2. ì…ë ¥ í¬ë§·</strong></h3>

<p>API spec ìƒ ë‚ ì§œ í˜•ì‹ì„ ì…ë ¥ë°›ì•„ì•¼ í•œë‹¤. ë‚ ì§œì˜ ê²½ìš° String ìœ¼ë¡œ ì…ë ¥ë°›ê³  ë‚ ì§œ í˜•ì‹ì€ ë‹¤ì–‘í•  ìˆ˜ ìˆì–´ ë¬¸ì„œì— ê¼­ í‘œê¸°ë¥¼ í•´ ì¤˜ì•¼ í–ˆë‹¤. ì…ë ¥ í¬ë§·ì„ ì§€ì •í•´ ì£¼ëŠ” ê²ƒë„ ê°„ë‹¨í•˜ë‹¤. <code class="language-plaintext highlighter-rouge">attributes()</code> ë©”ì†Œë“œë¥¼ ì´ìš©í•´ ì¶”ê°€ ì†ì„±ì„ ë„£ì–´ì¤„ ìˆ˜ ìˆë‹¤.  attributesì— <code class="language-plaintext highlighter-rouge">key("format").value("yyyyMMddHHmmss")</code>  ë¥¼ ê°ê° ë„£ì–´ì¤„ ìˆ˜ ìˆì§€ë§Œ ìì£¼ ì‚¬ìš©í•˜ë¯€ë¡œ static ë©”ì„œë“œë¡œ ì‘ì„±í•´ ì¤€ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DocumentFormatGenerator</span> <span class="o">{</span>
  <span class="kd">static</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">Attribute</span> <span class="nf">getDateFormat</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">key</span><span class="o">(</span><span class="s">"format"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"yyyyMMddHHmmss"</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì½”ë“œ ë° ê²°ê³¼ë¬¼ì€ ìœ„ì˜ ì˜ˆì‹œì™€ ì¤‘ë³µë˜ì–´ íŒ¨ìŠ¤</p>

<h3 id="3-ê³µí†µ-í¬ë§·"><strong>3. ê³µí†µ í¬ë§·</strong></h3>

<p>ê³µí†µ í¬ë§·ì—ëŠ” ê³µí†µ ì‘ë‹µê³¼ ê³µí†µ ì‘ë‹µ ì½”ë“œê°€ ìˆë‹¤. ì‘ì„± ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ol>
  <li>ê³µí†µ ì‘ë‹µ ì½”ë“œë¥¼ return í•´ ì£¼ëŠ” test controller ì‘ì„±</li>
  <li>test controller í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
    <ul>
      <li>ê³µí†µ ì‘ë‹µ
        <ul>
          <li><code class="language-plaintext highlighter-rouge">customResponseFields("custom-response", ...</code>
            <ul>
              <li>custom-response ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ìŠ¤ë‹ˆí« ìƒì„±</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>ê³µí†µ ì‘ë‹µ ì½”ë“œ</li>
    </ul>
  </li>
</ol>

<p><strong>[ê³µí†µ ì‘ë‹µ ì½”ë“œ]</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">ResultCode</span> <span class="kd">implements</span> <span class="nc">EnumType</span> <span class="o">{</span>

  <span class="no">SUCCESS</span><span class="o">(</span><span class="s">"0000"</span><span class="o">,</span> <span class="s">"ìš”ì²­ì´ ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."</span><span class="o">),</span>
  <span class="no">AUTHENTICATION_FAILED</span><span class="o">(</span><span class="s">"2000"</span><span class="o">,</span> <span class="s">"ì¸ì¦ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤."</span><span class="o">),</span>
  <span class="no">BAD_REQUEST</span><span class="o">(</span><span class="s">"4000"</span><span class="o">,</span> <span class="s">"ìš”ì²­ íŒŒë¼ë¯¸í„°ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."</span><span class="o">),</span>
  <span class="no">NOT_FOUND</span><span class="o">(</span><span class="s">"4040"</span><span class="o">,</span> <span class="s">"ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."</span><span class="o">),</span>
  <span class="no">SERVER_FILE_ERROR</span><span class="o">(</span><span class="s">"5001"</span><span class="o">,</span> <span class="s">"ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤."</span><span class="o">),</span>
  <span class="o">;</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">resultCode</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>

  <span class="nc">ResultCode</span><span class="o">(</span><span class="nc">String</span> <span class="n">resultCode</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">resultCode</span> <span class="o">=</span> <span class="n">resultCode</span><span class="o">;</span><span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="o">...</span> <span class="n">ìƒëµ</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>[ê³µí†µ ì‘ë‹µ ì½”ë“œ controller]</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentController</span> <span class="o">{</span>

  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/docs"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ApiResult</span><span class="o">&lt;</span><span class="nc">DocsCode</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>

    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">apiResponseCodes</span> <span class="o">=</span> <span class="n">getDocs</span><span class="o">(</span><span class="nc">ResultCode</span><span class="o">.</span><span class="na">values</span><span class="o">());</span>

    <span class="k">return</span> <span class="nc">ApiResult</span><span class="o">.</span><span class="na">succeed</span><span class="o">(</span>
        <span class="nc">DocsCode</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
            <span class="o">.</span><span class="na">responseCode</span><span class="o">(</span><span class="n">apiResponseCodes</span><span class="o">)</span>
            <span class="o">.</span><span class="na">build</span><span class="o">()</span>
    <span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getDocs</span><span class="o">(</span><span class="nc">EnumType</span><span class="o">[]</span> <span class="n">enumTypes</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">enumTypes</span><span class="o">)</span>
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toMap</span><span class="o">(</span><span class="nl">EnumType:</span><span class="o">:</span><span class="n">getId</span><span class="o">,</span> <span class="nl">EnumType:</span><span class="o">:</span><span class="n">getText</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>


</code></pre></div></div>

<p><strong>[í…ŒìŠ¤íŠ¸ ì½”ë“œ]</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">commons</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

<span class="c1">//when</span>
	<span class="nc">ResultActions</span> <span class="n">result</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
			<span class="n">get</span><span class="o">(</span><span class="s">"/docs"</span><span class="o">)</span>
					<span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>

	<span class="o">);</span>

	<span class="nc">MvcResult</span> <span class="n">mvcResult</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">andReturn</span><span class="o">();</span>
	<span class="nc">ApiResult</span><span class="o">&lt;</span><span class="nc">DocsCode</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">mvcResult</span><span class="o">.</span><span class="na">getResponse</span><span class="o">().</span><span class="na">getContentAsString</span><span class="o">(),</span>
				<span class="k">new</span> <span class="nc">TypeReference</span><span class="o">&lt;</span><span class="nc">ApiResult</span><span class="o">&lt;</span><span class="nc">DocsCode</span><span class="o">&gt;&gt;()</span> <span class="o">{});</span>

	<span class="nc">DocsCode</span> <span class="n">resultCodeDocs</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>


<span class="c1">//then</span>
	<span class="n">result</span><span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
			<span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span><span class="s">"common"</span><span class="o">,</span>
					<span class="n">customResponseFields</span><span class="o">(</span><span class="s">"custom-response"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span>
							<span class="n">attributes</span><span class="o">(</span><span class="n">key</span><span class="o">(</span><span class="s">"title"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"ê³µí†µì‘ë‹µ"</span><span class="o">)),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"code"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ì½”ë“œ"</span><span class="o">),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"message"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ë©”ì‹œì§€"</span><span class="o">),</span>
							<span class="n">subsectionWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë°ì´í„°"</span><span class="o">)</span>
					<span class="o">),</span>
					<span class="n">customResponseCodeFields</span><span class="o">(</span><span class="s">"custom-response-code"</span><span class="o">,</span> <span class="n">beneathPath</span><span class="o">(</span><span class="s">"data.responseCode"</span><span class="o">).</span><span class="na">withSubsectionId</span><span class="o">(</span><span class="s">"responseCode"</span><span class="o">),</span>
							<span class="n">attributes</span><span class="o">(</span><span class="n">key</span><span class="o">(</span><span class="s">"title"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"ê³µí†µ ì‘ë‹µì½”ë“œ"</span><span class="o">)),</span>
							<span class="n">enumConvertFieldDescriptor</span><span class="o">(</span><span class="n">resultCodeDocs</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">())</span>
					<span class="o">)</span>
			<span class="o">));</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="nc">FieldDescriptor</span><span class="o">[]</span> <span class="nf">enumConvertFieldDescriptor</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">enumValues</span><span class="o">)</span> <span class="o">{</span>

	<span class="k">return</span> <span class="n">enumValues</span><span class="o">.</span><span class="na">entrySet</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">fieldWithPath</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getKey</span><span class="o">()).</span><span class="na">description</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getValue</span><span class="o">()))</span>
			<span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="nc">FieldDescriptor</span><span class="o">[]::</span><span class="k">new</span><span class="o">);</span>
<span class="o">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="nc">CustomResponseFieldsSnippet</span> <span class="nf">customResponseFields</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">,</span>
		<span class="nc">PayloadSubsectionExtractor</span><span class="o">&lt;?&gt;</span> <span class="n">subsectionExtractor</span><span class="o">,</span>
		<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attributes</span><span class="o">,</span> <span class="nc">FieldDescriptor</span><span class="o">...</span> <span class="n">descriptors</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">return</span> <span class="k">new</span> <span class="nf">CustomResponseFieldsSnippet</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">subsectionExtractor</span><span class="o">,</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">descriptors</span><span class="o">),</span> <span class="n">attributes</span>
			<span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
<span class="o">}</span>



</code></pre></div></div>

<h3 id="4-ê³„ì¸µ-êµ¬ì¡°-ì‘ë‹µ"><strong>4. ê³„ì¸µ êµ¬ì¡° ì‘ë‹µ</strong></h3>

<p>pagination ì²˜ë¦¬ê°€ ëœ ì‘ë‹µê³¼ ê°™ì´ ê³„ì¸µ êµ¬ì¡°ì˜ ì‘ë‹µì„ ë‹¨ìˆœí•˜ê²Œ í‘œí˜„í•´ì•¼ í–ˆë‹¤.</p>

<ol>
  <li>benethPath() ë©”ì„œë“œë¥¼ ì´ìš©í•´ data.data í•˜ìœ„ í•­ëª©ë§Œ reponse fieldë¡œ ì‘ì„±í•˜ê¸°
    <ul>
      <li>benethPathë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ data.service, data.account_id ì´ëŸ° ì‹ìœ¼ë¡œ í‘œí˜„ëœë‹¤</li>
    </ul>
  </li>
  <li>pagination ì‘ë‹µ ìŠ¤ë‹ˆí« ë”°ë¡œ ìƒì„±
    <ul>
      <li>pagination ì‘ë‹µ ìŠ¤ë‹ˆí«ì„ ë”°ë¡œ ìƒì„±í•´ì„œ ëª…í™•í•˜ê²Œ ë³´ì—¬ì£¼ê³ ì í–ˆë‹¤.</li>
    </ul>
  </li>
</ol>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logApiResultAction</span>
		<span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="nc">MockMvcResultMatchers</span>
				<span class="o">.</span><span class="na">content</span><span class="o">()</span>
				<span class="o">.</span><span class="na">string</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="nc">ApiResult</span><span class="o">.</span><span class="na">succeed</span><span class="o">(</span><span class="n">logResponse</span><span class="o">))))</span>
		<span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span><span class="s">"pips-access-log-api"</span><span class="o">,</span>
				<span class="n">getDocumentRequest</span><span class="o">(),</span>
				<span class="n">getDocumentResponse</span><span class="o">(),</span>
				<span class="n">requestHeaders</span><span class="o">(</span>
						<span class="n">headerWithName</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"Bearer auth credentials"</span><span class="o">)</span>
				<span class="o">),</span>
				<span class="n">requestFields</span><span class="o">(</span>
						<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"startDate"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">attributes</span><span class="o">(</span><span class="n">getDateFormat</span><span class="o">()).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë¡œê·¸ ì¡°íšŒ ì‹œì‘ ë‚ ì§œ"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
						<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"endDate"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">attributes</span><span class="o">(</span><span class="n">getDateFormat</span><span class="o">()).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë¡œê·¸ ì¡°íšŒ ë ë‚ ì§œ"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
						<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"pageNum"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"í˜ì´ì§€ ë²ˆí˜¸"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
						<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"pageSize"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì¡°íšŒ ê±´ìˆ˜"</span><span class="o">).</span><span class="na">optional</span><span class="o">()</span>
				<span class="o">),</span>
				<span class="n">responseFields</span><span class="o">(</span>
						<span class="n">beneathPath</span><span class="o">(</span><span class="s">"data.data"</span><span class="o">),</span><span class="c1">//(1)</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"id"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"Unique Id"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"service_name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê°œì¸ì •ë³´ ë°ì´í„°ì— ì ‘ê·¼ëœ ì‹œìŠ¤í…œ ëª…"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"account_id"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê°œì¸ì •ë³´ ë°ì´í„°ì— ì ‘ê·¼í•œ ê³„ì •ID"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"access_time"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê°œì¸ì •ë³´ ë°ì´í„°ì— ì ‘ê·¼í•œ ì‹œê°„ (ISO 8601 String)"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"access_menu"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì‚¬ìš©ì(ì§ì›)ì´ ê°œì¸ì •ë³´ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©í•œ ì‹œìŠ¤í…œì˜ ë©”ë‰´"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"location"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"IP Location"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"activity_category"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê°œì¸ì •ë³´ ë°ì´í„° ì·¨ê¸‰ activity"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"access_data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì ‘ê·¼í•œ ê°œì¸ì •ë³´ ë°ì´í„°ì˜ ì¢…ë¥˜"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data_subject"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì •ë³´ì£¼ì²´ì˜ ì •ë³´"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
							<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"bulk_query"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë‹¤ìˆ˜ì˜ ì •ë³´ì£¼ì²´ì˜ ì •ë³´ì— ì ‘ê·¼í–ˆì„ ì‹œ ì¿¼ë¦¬"</span><span class="o">).</span><span class="na">optional</span><span class="o">()</span>
				<span class="o">),</span>
<span class="c1">//(2)</span>
				<span class="n">customResponseFields</span><span class="o">(</span><span class="s">"response"</span><span class="o">,</span> <span class="n">beneathPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">withSubsectionId</span><span class="o">(</span><span class="s">"pagination"</span><span class="o">),</span>
						<span class="n">attributes</span><span class="o">(</span><span class="n">key</span><span class="o">(</span><span class="s">"title"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"í˜ì´ì§€ë„¤ì´ì…˜ ì‘ë‹µì½”ë“œ"</span><span class="o">)),</span>
						<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"hasNext"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">BOOLEAN</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë‹¤ìŒ í˜ì´ì§€ ì—¬ë¶€"</span><span class="o">),</span>
						<span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">ARRAY</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ë¡œê·¸ ì •ë³´"</span><span class="o">)</span>
				<span class="o">)</span>
		<span class="o">))</span>
		<span class="o">.</span><span class="na">andReturn</span><span class="o">();</span>
</code></pre></div></div>

<h2 id="ìµœì¢…-ê²°ê³¼ë¬¼">ìµœì¢… ê²°ê³¼ë¬¼</h2>

<p><img src="https://swimmingHwang.github.io/img/image-20220417-185120.png" alt="image-20220417-185120" /></p>

<h2 id="ë§ˆë¬´ë¦¬">ë§ˆë¬´ë¦¬</h2>

<p>ì²˜ìŒì— í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•´ì„œ ë§ì´ ë²„ë²…ê±°ë ¸ëŠ”ë° í•œ ë²ˆ ì‘ì„±í•´ ë‘ë‹ˆ ë„ˆë¬´ í¸í–ˆë‹¤. <br />
(ê°•ì œë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì§œë´ì„œ ë„ì›€ë˜ê¸°ë„ í–ˆë‹¤..) ìš°ë¦¬ íŒ€ì—ì„œ Swaggerë§Œ ì“°ê¸´í•˜ì§€ë§Œ, ë‹¤ë¥¸ REST API ë¥¼ ë§Œë“¤ê³  ì™¸ë¶€ì— ë°°í¬í•´ì•¼ í•  ë•Œ, ì‚¬ìš©í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ ê³µìœ í•œë‹¤. <br />
ê·¸ë¦¬ê³  Spring REST Docs ì‘ì„±í•˜ëŠ” ë°©ë²•ë„ ë” ë‹¤ì–‘í•˜ë‹ˆ í”„ë¡œì íŠ¸ íŠ¹ì„±ì— ë§ê²Œ í™œìš©í•˜ì—¬ ì“°ë©´ ë  ê²ƒ ê°™ë‹¤.</p>

<h3 id="ì°¸ê³ "><strong>ì°¸ê³ </strong></h3>

<ul>
  <li>
    <p><a href="https://docs.spring.io/spring-restdocs/docs/current/reference/html5/">Spring REST Docs</a></p>
  </li>
  <li>
    <p><a href="https://techblog.woowahan.com/2597/">Spring Rest Docs ì ìš© - ìš°ì•„í•œí˜•ì œë“¤ ê¸°ìˆ ë¸”ë¡œê·¸</a></p>
  </li>
  <li>
    <p><a href="https://techblog.woowahan.com/2678/">Spring REST Docsì— ë‚ ê°œë¥¼â€¦ (feat: Popup) - ìš°ì•„í•œí˜•ì œë“¤ ê¸°ìˆ ë¸”ë¡œê·¸</a></p>
  </li>
</ul>
:ET